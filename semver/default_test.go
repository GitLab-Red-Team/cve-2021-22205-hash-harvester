package semver_test

import (
	"github.com/stretchr/testify/assert"
	"github.com/stretchr/testify/suite"
	"gitlab.com/gitlab-red-team/private-research/cve-2021-22205-hash-generator/semver"
	"testing"
)

type SemVerTestSuite struct {
	suite.Suite
	Constraints []string
}

func (suite *SemVerTestSuite) SetupTest() {
	suite.Constraints = append(suite.Constraints, ">=11.9, <13.8.8")
	suite.Constraints = append(suite.Constraints,">=13.9, <13.9.6")
	suite.Constraints = append(suite.Constraints,">=13.10, <13.10.3")
}

func (suite *SemVerTestSuite) TestVersionIsInRange() {
	isInRange, e := semver.VersionIsInRange(suite.Constraints, "11.9.1")
	assert.True(suite.T(), isInRange)
	assert.True(suite.T(), e == nil)
}

func TestSemVerTestSuite(t *testing.T) {
	suite.Run(t, new(SemVerTestSuite))
}
