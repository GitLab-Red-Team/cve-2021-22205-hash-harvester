package main

import (
	"fmt"
	"gitlab.com/gitlab-red-team/private-research/cve-2021-22205-hash-generator/tags"
)

func getAllTagNames() []string {
	var allTagNames []string
	ceTags := tags.GetDockerTags(tags.Tag{Edition: tags.CE})
	eeTags := tags.GetDockerTags(tags.Tag{Edition: tags.EE})
	for _, t := range ceTags {
		allTagNames = append(allTagNames, t.Name)
	}
	for _, t := range eeTags {
		allTagNames = append(allTagNames, t.Name)
	}
	return allTagNames
}

func main() {
	allTagNames := getAllTagNames()
	fmt.Printf("[*] Found a total of %d tags for GitLab EE and CE editions...", len(allTagNames))
}
